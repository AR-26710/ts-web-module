var n=Object.defineProperty,t=(t,e,s)=>(((t,e,s)=>{e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s})(t,"symbol"!=typeof e?e+"":e,s),s);class e extends HTMLElement{constructor(){super(),t(this,"shadow"),t(this,"passwordInput",null),t(this,"submitButton",null),t(this,"errorMessage",null),t(this,"contentWrapper",null),t(this,"isUnlocked",!1),this.shadow=this.attachShadow({mode:"open"}),this.render(),this.cacheElements()}static get observedAttributes(){return["pw","title","tip","placeholder","error"]}connectedCallback(){this.addEventListeners()}disconnectedCallback(){this.removeEventListeners()}attributeChangedCallback(n,t,e){"pw"===n&&this.isUnlocked&&this.lockContent(),"title"!==n&&"tip"!==n&&"placeholder"!==n&&"error"!==n||t===e||this.updateTextContent()}cacheElements(){this.passwordInput=this.shadow.querySelector(".pb-password-input"),this.submitButton=this.shadow.querySelector(".pb-submit-btn"),this.errorMessage=this.shadow.querySelector(".pb-error-message"),this.contentWrapper=this.shadow.querySelector(".pb-content-wrapper")}render(){const n=document.createElement("style");n.textContent="\n      :host {\n        display: block;\n        width: 100%;\n        margin: 16px 0;\n        font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n      }\n\n      .pb-container {\n        border-radius: 12px;\n        padding: 24px;\n        background-color: #ffffff;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n        transition: all 0.3s ease;\n        position: relative;\n        overflow: hidden;\n      }\n\n      .pb-container::before {\n        content: '';\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 4px;\n      }\n\n      .pb-container.locked {\n        background-color: #fff9e6;\n        border: 1px solid #ffeaa7;\n      }\n\n      .pb-container.unlocked {\n        border: 1px solid #a8e6a1;\n      }\n\n      .pb-password-section {\n        text-align: center;\n        margin-bottom: 20px;\n      }\n\n      .pb-title {\n        font-size: 20px;\n        font-weight: 600;\n        color: #2d3748;\n        margin-bottom: 16px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n      }\n\n      .pb-lock-icon {\n        font-size: 24px;\n      }\n\n      .pb-input-group {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        max-width: 300px;\n        margin: 0 auto;\n      }\n\n      .pb-password-input {\n        padding: 12px 16px;\n        border: 2px solid #e2e8f0;\n        border-radius: 8px;\n        font-size: 16px;\n        width: 100%;\n        transition: all 0.3s ease;\n        box-sizing: border-box;\n      }\n\n      .pb-password-input:focus {\n        outline: none;\n        border-color: #4361ee;\n        box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);\n      }\n\n      .pb-password-input.error {\n        border-color: #e53e3e;\n        animation: shake 0.5s ease;\n      }\n\n      .pb-submit-btn {\n        padding: 12px 20px;\n        background: linear-gradient(135deg, #4361ee, #3a0ca3);\n        color: white;\n        border: none;\n        border-radius: 8px;\n        font-size: 16px;\n        font-weight: 500;\n        cursor: pointer;\n        transition: all 0.3s ease;\n        box-shadow: 0 2px 6px rgba(67, 97, 238, 0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n      }\n\n      .pb-submit-btn:hover {\n        background: linear-gradient(135deg, #3a56d4, #320a8c);\n        box-shadow: 0 4px 10px rgba(67, 97, 238, 0.4);\n        transform: translateY(-2px);\n      }\n\n      .pb-submit-btn:active {\n        transform: translateY(0);\n        box-shadow: 0 2px 4px rgba(67, 97, 238, 0.3);\n      }\n\n      .pb-submit-btn:disabled {\n        background: #a0aec0;\n        cursor: not-allowed;\n        transform: none;\n        box-shadow: none;\n      }\n\n      .pb-error-message {\n        color: #e53e3e;\n        font-size: 14px;\n        margin: 8px auto 0;\n        display: none;\n        background-color: #fef2f2;\n        padding: 8px 12px;\n        border-radius: 6px;\n        max-width: 300px;\n        box-sizing: border-box;\n      }\n\n      .pb-error-message.show {\n        display: block;\n        animation: fadeIn 0.3s ease;\n      }\n\n      .pb-content-wrapper {\n        display: none;\n        animation: fadeIn 0.5s ease;\n      }\n\n      .pb-content-wrapper.show {\n        display: block;\n      }\n\n      .pb-hint {\n        font-size: 14px;\n        color: #718096;\n        margin: 12px auto 0;\n        padding: 8px 12px;\n        background-color: #f7fafc;\n        border-radius: 6px;\n        max-width: 300px;\n        box-sizing: border-box;\n      }\n\n      @keyframes fadeIn {\n        from {\n          opacity: 0;\n          transform: translateY(10px);\n        }\n        to {\n          opacity: 1;\n          transform: translateY(0);\n        }\n      }\n\n      @keyframes shake {\n        0%, 100% { transform: translateX(0); }\n        20%, 60% { transform: translateX(-5px); }\n        40%, 80% { transform: translateX(5px); }\n      }\n\n      /* 响应式设计 */\n      @media (max-width: 480px) {\n        .pb-container {\n          padding: 20px 16px;\n        }\n        \n        .pb-title {\n          font-size: 18px;\n        }\n        \n        .pb-input-group {\n          max-width: 100%;\n        }\n      }\n    ";const t=document.createElement("div");t.className="pb-container locked";const e=this.getAttribute("title")||"请输入密码查看内容",s=this.getAttribute("tip")||"",o=this.getAttribute("placeholder")||"请输入密码",i=this.getAttribute("error")||"密码错误，请重试";t.innerHTML=`\n      <div class="pb-password-section">\n        <div class="pb-title">\n          <span class="pb-lock-icon">🔒</span>\n          <span class="pb-title-text">${e}</span>\n        </div>\n        <div class="pb-input-group">\n          <input type="password" class="pb-password-input" placeholder="${o}">\n          <button class="pb-submit-btn">\n            <span>验证密码</span>\n          </button>\n        </div>\n        <div class="pb-error-message">${i}</div>\n        ${s?`<div class="pb-hint">${s}</div>`:""}\n      </div>\n      <div class="pb-content-wrapper">\n        <slot></slot>\n      </div>\n    `,this.shadow.append(n,t)}addEventListeners(){var n,t;null==(n=this.submitButton)||n.addEventListener("click",this.handleSubmit.bind(this)),null==(t=this.passwordInput)||t.addEventListener("keypress",this.handleKeyPress.bind(this))}removeEventListeners(){var n,t;null==(n=this.submitButton)||n.removeEventListener("click",this.handleSubmit.bind(this)),null==(t=this.passwordInput)||t.removeEventListener("keypress",this.handleKeyPress.bind(this))}handleKeyPress(n){"Enter"===n.key&&this.handleSubmit()}handleSubmit(){var n;const t=(null==(n=this.passwordInput)?void 0:n.value)||"",e=this.getAttribute("pw")||"";this.submitButton&&(this.submitButton.disabled=!0,this.submitButton.innerHTML="<span>验证中...</span>"),setTimeout(()=>{t===e?this.unlockContent():this.showError(),this.submitButton&&(this.submitButton.disabled=!1,this.submitButton.innerHTML="<span>验证密码</span>")},600)}updateTextContent(){if(this.isUnlocked){const n=this.shadow.querySelector(".pb-title-text"),t=this.getAttribute("title")||"请输入密码查看内容";n&&(n.textContent=t)}else{const n=this.shadow.querySelector(".pb-title-text"),t=this.getAttribute("title")||"请输入密码查看内容";n&&(n.textContent=t);const e=this.shadow.querySelector(".pb-hint"),s=this.getAttribute("tip")||"";if(e)s?(e.textContent=s,e.style.display="block"):e.style.display="none";else if(s){const n=this.shadow.querySelector(".pb-password-section"),t=document.createElement("div");t.className="pb-hint",t.textContent=s,null==n||n.appendChild(t)}const o=this.getAttribute("placeholder")||"请输入密码";this.passwordInput&&(this.passwordInput.placeholder=o);const i=this.getAttribute("error")||"密码错误，请重试";this.errorMessage&&(this.errorMessage.textContent=i)}}unlockContent(){this.isUnlocked=!0;const n=this.shadow.querySelector(".pb-container"),t=this.contentWrapper,e=this.shadow.querySelector(".pb-password-section");n.classList.remove("locked"),n.classList.add("unlocked"),t.classList.add("show"),e.style.display="none",this.hideError(),this.dispatchEvent(new CustomEvent("password-correct",{detail:{unlocked:!0},bubbles:!0}))}lockContent(){this.isUnlocked=!1;const n=this.shadow.querySelector(".pb-container"),t=this.contentWrapper,e=this.shadow.querySelector(".pb-password-section");n.classList.remove("unlocked"),n.classList.add("locked"),t.classList.remove("show"),e.style.display="block",this.passwordInput&&(this.passwordInput.value=""),this.updateTextContent()}showError(){this.errorMessage.classList.add("show");const n=this.passwordInput;n.classList.add("error"),setTimeout(()=>{n.classList.remove("error")},500),setTimeout(()=>{this.hideError()},3e3)}hideError(){this.errorMessage.classList.remove("show")}unlock(n){return n===(this.getAttribute("pw")||"")&&(this.unlockContent(),!0)}lock(){this.lockContent()}get isContentUnlocked(){return this.isUnlocked}}customElements.define("password-box",e);const s="password-box";export{s as PASSWORD_BOX_MODULE};
