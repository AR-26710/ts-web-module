var e=Object.defineProperty,t=(t,n,s)=>(((t,n,s)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s})(t,"symbol"!=typeof n?n+"":n,s),s);class n extends HTMLElement{constructor(){super(),t(this,"shadow"),t(this,"currentIndex",0),t(this,"items",[]),t(this,"loadedIndices",new Set),t(this,"preloadDistance",6),this.shadow=this.attachShadow({mode:"open"}),this.render()}connectedCallback(){this.buildGallery(),this.addEventListeners()}render(){const e=document.createElement("style");e.textContent="\n      .gb-gallery-container {\n        position: relative;\n        width: 100%;\n        max-width: 800px;\n        margin: 0 auto;\n        overflow: hidden;\n        border-radius: 8px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      }\n\n      .gb-gallery-track {\n        display: flex;\n        transition: transform 0.3s ease;\n      }\n\n      .gb-gallery-item {\n        min-width: 100%;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n\n      .gb-gallery-item img {\n        max-width: 100%;\n        max-height: 600px;\n        object-fit: contain;\n        transition: opacity 0.3s ease;\n      }\n\n      .gb-gallery-item img.loading {\n        opacity: 0.3;\n        background: #f5f5f5;\n      }\n\n      .gb-gallery-item img.loaded {\n        opacity: 1;\n      }\n\n      .gb-gallery-item img.error {\n        opacity: 1;\n        background: #ffebee;\n        color: #b71c1c;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n\n      .gb-gallery-nav {\n        position: absolute;\n        top: 50%;\n        transform: translateY(-50%);\n        background: rgba(0, 0, 0, 0.5);\n        color: white;\n        border: none;\n        font-size: 24px;\n        padding: 12px 16px;\n        cursor: pointer;\n        transition: background 0.3s;\n        user-select: none;\n      }\n\n      .gb-gallery-nav:hover {\n        background: rgba(0, 0, 0, 0.8);\n      }\n\n      .gb-gallery-nav.disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n\n      .gb-gallery-nav.prev {\n        left: 16px;\n      }\n\n      .gb-gallery-nav.next {\n        right: 16px;\n      }\n\n\n\n      .gb-gallery-counter {\n        position: absolute;\n        bottom: 16px;\n        right: 16px;\n        background: rgba(0, 0, 0, 0.5);\n        color: white;\n        padding: 4px 12px;\n        border-radius: 12px;\n        font-size: 14px;\n      }\n    ";const t=document.createElement("div");t.className="gb-gallery-container",t.innerHTML='\n      <div class="gb-gallery-track"></div>\n      <button class="gb-gallery-nav prev">‹</button>\n      <button class="gb-gallery-nav next">›</button>\n      <div class="gb-gallery-counter"></div>\n    ',this.shadow.append(e,t)}buildGallery(){this.items=Array.from(this.children);const e=this.shadow.querySelector(".gb-gallery-track"),t=this.shadow.querySelector(".gb-gallery-counter");e&&t&&(e.innerHTML="",this.items.forEach((t,n)=>{const s=document.createElement("div");s.className="gb-gallery-item",s.dataset.index=n.toString();const r=t.cloneNode(!0);if(r instanceof Element&&"IMG"===r.tagName){const e=r,t=e.src;e.src="",e.dataset.src=t,e.classList.add("loading")}else if(r instanceof Element&&r.querySelector("img")){const e=r.querySelector("img"),t=e.src;e.src="",e.dataset.src=t,e.classList.add("loading")}s.appendChild(r),e.appendChild(s)}),this.updateCounter(),this.loadVisibleImages())}addEventListeners(){const e=this.shadow.querySelector(".gb-gallery-nav.prev"),t=this.shadow.querySelector(".gb-gallery-nav.next");null==e||e.addEventListener("click",()=>this.prev()),null==t||t.addEventListener("click",()=>this.next()),window.addEventListener("resize",()=>this.loadVisibleImages()),window.addEventListener("scroll",()=>this.loadVisibleImages())}updateGallery(){const e=this.shadow.querySelector(".gb-gallery-track"),t=this.shadow.querySelector(".gb-gallery-counter"),n=this.shadow.querySelector(".gb-gallery-nav.prev"),s=this.shadow.querySelector(".gb-gallery-nav.next");e&&t&&n&&s&&(e.style.transform=`translateX(-${100*this.currentIndex}%)`,n.classList.remove("disabled"),s.classList.remove("disabled"),this.updateCounter(),this.loadVisibleImages())}loadVisibleImages(){const e=Math.max(0,this.currentIndex-this.preloadDistance),t=Math.min(this.items.length-1,this.currentIndex+this.preloadDistance);for(let n=e;n<=t;n++)this.loadedIndices.has(n)||this.loadImageAtIndex(n)}loadImageAtIndex(e){if(e<0||e>=this.items.length)return;const t=this.shadow.querySelector(".gb-gallery-track");if(!t)return;const n=t.children[e];if(!n)return;const s=n.querySelector("img");if(!s||!s.dataset.src)return;const r=s.dataset.src,i=new Image;i.onload=()=>{s.src=r,s.classList.remove("loading"),s.classList.add("loaded"),this.loadedIndices.add(e)},i.onerror=()=>{s.classList.remove("loading"),s.classList.add("error")},i.src=r}unloadImageAtIndex(e){if(e<0||e>=this.items.length)return;const t=this.shadow.querySelector(".gb-gallery-track");if(!t)return;const n=t.children[e];if(!n)return;const s=n.querySelector("img");s&&s.dataset.src&&(s.src="",s.classList.remove("loaded","error"),s.classList.add("loading"),this.loadedIndices.delete(e))}updateCounter(){const e=this.shadow.querySelector(".gb-gallery-counter");e&&this.items.length>0&&(e.textContent=`${this.currentIndex+1} / ${this.items.length}`)}prev(){const e=(this.currentIndex-1+this.items.length)%this.items.length;this.slideToIndex(e,"prev")}next(){const e=(this.currentIndex+1)%this.items.length;this.slideToIndex(e,"next")}slideToIndex(e,t){const n=this.shadow.querySelector(".gb-gallery-track");if(!n)return;n.style.transition="transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)";"next"===t&&0===e&&this.currentIndex===this.items.length-1||"prev"===t&&e===this.items.length-1&&0===this.currentIndex?this.performLoopTransition(e,t):(this.currentIndex=e,n.style.transform=`translateX(-${100*this.currentIndex}%)`,setTimeout(()=>{this.updateCounter(),this.loadVisibleImages()},500))}performLoopTransition(e,t){const n=this.shadow.querySelector(".gb-gallery-track");n&&("next"===t&&0===e&&this.currentIndex===this.items.length-1?(this.currentIndex=e,n.style.transition="transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)",n.style.transform=`translateX(-${100*this.items.length}%)`,setTimeout(()=>{n.style.transition="none",n.style.transform="translateX(0%)",setTimeout(()=>{n.style.transition="transform 0.3s ease",this.updateCounter(),this.loadVisibleImages()},50)},500)):"prev"===t&&e===this.items.length-1&&0===this.currentIndex&&(this.currentIndex=e,n.style.transition="none",n.style.transform=`translateX(-${100*this.items.length}%)`,setTimeout(()=>{n.style.transition="transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)",n.style.transform=`translateX(-${100*(this.items.length-1)}%)`,setTimeout(()=>{n.style.transition="transform 0.3s ease",this.updateCounter(),this.loadVisibleImages()},500)},50)))}goTo(e){if(e>=0&&e<this.items.length&&e!==this.currentIndex){const t=e>this.currentIndex?"next":"prev";this.slideToIndex(e,t)}}}customElements.define("gallery-component",n);
